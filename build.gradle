buildscript {
    repositories {
        mavenCentral()
        mavenLocal()
    }
      dependencies {
        classpath 'com.android.tools.build:gradle:1.2.3'
        classpath 'com.jakewharton.hugo:hugo-plugin:1.2.1'
//        classpath 'org.robolectric:robolectric-gradle-plugin:1.0.0-SNAPSHOT'
    }
}
dependencies {
      repositories {
        mavenCentral()

        // NOTE: This is only needed when developing the plugin!
        mavenLocal()
    }
}
def String getProjectProperty(String propertyName) {
        String propertyValue = "null"
        if (hasProperty(propertyName)) {
            propertyValue = this.properties[propertyName]
        } else {
            throw GradleScriptException("PropertyName " + propertyName + " is not defined in properties file")
        }
        return propertyValue
}


gradle.projectsEvaluated {
    def projects=["date-time-picker","widget","settings","colorpickerpreference","donationslib","new_ui"]
    for(String proj:projects){
        def res_dir=rootDir.toString()+"/"+proj+"/res"
        def res_v14_dir=rootDir.toString()+"/"+proj+"/res-v14"
        def script = (rootDir.toString()+"/build/scripts/generate_v14_compatible_resources.py --res-dir "+res_dir+" --res-v14-compatibility-dir "+res_v14_dir+"").execute()
        script.err.eachLine {line -> println "ERROR: " + line}
        script.waitFor()
        def res = fileTree(dir: res_dir)
        def res_v14 =fileTree(dir: res_v14_dir)
        delete proj+"/merged-res";
        copy{
            from (res_dir){
                include '**/*.xml', '**/*.png'
            }
            from (res_v14_dir){
                include '**/*.xml', '**/*.png'
            }
            into (rootDir.toString()+"/"+proj+"/merged-res") 
        }
    }
}
ext {
    compileSdkVersion = 21
    buildToolsVersion = "21.1.1"
    minSDKVersion = 11
}

configure(allprojects) {
    ext.androidSDKVersion = "21"
    ext.androidBuildToolsVersion = "21.1.0"
    ext.androidSupportVersion = "22.1.+"
    ext.androidPluginVersion ="0.14.0"
    ext.androidMinSDKVersion ="14"
    ext.jodaLibraryVersion = "2.2"
    ext.nineoldandroisVersion="2.4.0"
    ext.robotiumVersion = "5.2.1"
    ext.gsonVersion = "2.2.+"
    ext.junitVersion = "4.11"
    ext.guavaVersion = "17.0"
    ext.butterknifeVersion = "6.1.0"
    ext.dashclockVersion = "2.0.0"
    ext.robolectricVersion= "2.3"
    ext.FAB_VERSION= "0.0.8"
    ext.snackbarVersion = "2.10.6"
    ext.materialdesignVersion = "1.0"
}

allprojects {
    repositories {                   
        mavenCentral()
            jcenter()
    }
    gradle.projectsEvaluated {
        tasks.withType(JavaCompile) {
            options.compilerArgs << "-Xlint:unchecked" << "-Xlint:deprecation"
        }
    }

}
task wrapper(type: Wrapper) {
    gradleVersion = '2.4'
}